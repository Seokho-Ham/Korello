{"ast":null,"code":"import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/Users/cocoball/korello-practice/korello/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cocoball/korello-practice/korello/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/cocoball/korello-practice/korello/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{memo,useState}from'react';import{usePostApi,useUpdateApi}from'../../api/index';import{useDrag}from'react-dnd';import CardModal from'./CardModal';var CardListForm=function CardListForm(_ref){var id=_ref.id,title=_ref.title,tag=_ref.tag,memberNames=_ref.memberNames,labels=_ref.labels,url=_ref.url,setUpdate=_ref.setUpdate;var _useDrag=useDrag({item:{type:'card',id:id,tagValue:tag},collect:function collect(monitor){return{isDragging:monitor.isDragging()};}}),_useDrag2=_slicedToArray(_useDrag,2),isDragging=_useDrag2[0].isDragging,drag=_useDrag2[1];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),edit=_useState2[0],setEdit=_useState2[1];var _useState3=useState(title),_useState4=_slicedToArray(_useState3,2),cardTitle=_useState4[0],setCardTitle=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),modalVisible=_useState6[0],setModalVisible=_useState6[1];var _usePostApi=usePostApi(),_usePostApi2=_slicedToArray(_usePostApi,1),postData=_usePostApi2[0];var _useUpdateApi=useUpdateApi(),_useUpdateApi2=_slicedToArray(_useUpdateApi,1),updateData=_useUpdateApi2[0];var editCard=function editCard(){setEdit(function(p){return!p;});};var inputHandler=function inputHandler(e){setCardTitle(e.target.value);};var clickModal=function clickModal(){setModalVisible(function(p){return!p;});};var sendUpdate=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var code;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(cardTitle!==title)){_context.next=7;break;}_context.next=3;return updateData(url.slice(0,url.length-1)+'/name',{id:id,name:cardTitle});case 3:code=_context.sent;if(code===200){setEdit(function(p){return!p;});setUpdate(function(prevState){return!prevState;});}else{alert('update 실패');}_context.next=8;break;case 7:setEdit(function(p){return!p;});case 8:case\"end\":return _context.stop();}}},_callee);}));return function sendUpdate(){return _ref2.apply(this,arguments);};}();var deleteCard=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var result_code;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(id);_context2.next=3;return postData(url.slice(0,url.length-1)+'/delete',{id:id});case 3:result_code=_context2.sent;if(result_code===201){setUpdate(function(prevState){return!prevState;});}else{alert('삭제에 실패하였습니다.');setUpdate(function(prevState){return!prevState;});}case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function deleteCard(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[modalVisible?/*#__PURE__*/_jsx(CardModal,{onClose:clickModal,id:id,title:title,tag:tag,url:url,setUpdate:setUpdate,labels:labels}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"card\",opacity:isDragging?0.5:1,ref:edit?null:drag,children:[labels.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"card-labels\",children:labels.sort(function(a,b){return a.id-b.id;}).map(function(el,i){return/*#__PURE__*/_jsx(\"span\",{className:\"label\",style:{backgroundColor:el.color}},i);})}):null,edit?/*#__PURE__*/_jsxs(\"div\",{className:\"card-input\",children:[/*#__PURE__*/_jsx(\"input\",{value:cardTitle,onChange:inputHandler}),/*#__PURE__*/_jsx(\"button\",{onClick:sendUpdate,children:\"save\"})]}):/*#__PURE__*/_jsx(\"div\",{onClick:editCard,children:title}),edit?null:/*#__PURE__*/_jsxs(\"div\",{className:\"card-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"modal\",onClick:clickModal,children:\"modal\"}),/*#__PURE__*/_jsx(\"button\",{className:\"card-delete-button\",onClick:deleteCard,children:\"X\"})]})]})]});};export default/*#__PURE__*/memo(CardListForm);","map":{"version":3,"sources":["/Users/cocoball/korello-practice/korello/src/components/card/CardListForm.jsx"],"names":["React","memo","useState","usePostApi","useUpdateApi","useDrag","CardModal","CardListForm","id","title","tag","memberNames","labels","url","setUpdate","item","type","tagValue","collect","monitor","isDragging","drag","edit","setEdit","cardTitle","setCardTitle","modalVisible","setModalVisible","postData","updateData","editCard","p","inputHandler","e","target","value","clickModal","sendUpdate","slice","length","name","code","prevState","alert","deleteCard","console","log","result_code","sort","a","b","map","el","i","backgroundColor","color"],"mappings":"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","sourcesContent":["import React, { memo, useState } from 'react';\nimport { usePostApi, useUpdateApi } from '../../api/index';\nimport { useDrag } from 'react-dnd';\nimport CardModal from './CardModal';\n\nconst CardListForm = ({\n  id,\n  title,\n  tag,\n  memberNames,\n  labels,\n  url,\n  setUpdate,\n}) => {\n  const [{ isDragging }, drag] = useDrag({\n    item: { type: 'card', id: id, tagValue: tag },\n    collect: monitor => ({\n      isDragging: monitor.isDragging(),\n    }),\n  });\n  const [edit, setEdit] = useState(false);\n  const [cardTitle, setCardTitle] = useState(title);\n  const [modalVisible, setModalVisible] = useState(false);\n  const [postData] = usePostApi();\n  const [updateData] = useUpdateApi();\n\n  const editCard = () => {\n    setEdit(p => !p);\n  };\n  const inputHandler = e => {\n    setCardTitle(e.target.value);\n  };\n\n  const clickModal = () => {\n    setModalVisible(p => !p);\n  };\n\n  const sendUpdate = async () => {\n    if (cardTitle !== title) {\n      let code = await updateData(url.slice(0, url.length - 1) + '/name', {\n        id: id,\n        name: cardTitle,\n      });\n      if (code === 200) {\n        setEdit(p => !p);\n        setUpdate(prevState => !prevState);\n      } else {\n        alert('update 실패');\n      }\n    } else {\n      setEdit(p => !p);\n    }\n  };\n\n  const deleteCard = async () => {\n    console.log(id);\n    let result_code = await postData(url.slice(0, url.length - 1) + '/delete', {\n      id: id,\n    });\n    if (result_code === 201) {\n      setUpdate(prevState => !prevState);\n    } else {\n      alert('삭제에 실패하였습니다.');\n      setUpdate(prevState => !prevState);\n    }\n  };\n\n  return (\n    <>\n      {modalVisible ? (\n        <CardModal\n          onClose={clickModal}\n          id={id}\n          title={title}\n          tag={tag}\n          url={url}\n          setUpdate={setUpdate}\n          labels={labels}\n        />\n      ) : null}\n      <div\n        className='card'\n        opacity={isDragging ? 0.5 : 1}\n        ref={edit ? null : drag}\n      >\n        {labels.length > 0 ? (\n          <div className='card-labels'>\n            {labels\n              .sort((a, b) => a.id - b.id)\n              .map((el, i) => (\n                <span\n                  key={i}\n                  className='label'\n                  style={{\n                    backgroundColor: el.color,\n                  }}\n                ></span>\n              ))}\n          </div>\n        ) : null}\n        {edit ? (\n          <div className='card-input'>\n            <input value={cardTitle} onChange={inputHandler} />\n            <button onClick={sendUpdate}>save</button>\n          </div>\n        ) : (\n          <div onClick={editCard}>{title}</div>\n        )}\n        {edit ? null : (\n          <div className='card-buttons'>\n            <button className='modal' onClick={clickModal}>\n              modal\n            </button>\n            <button className='card-delete-button' onClick={deleteCard}>\n              X\n            </button>\n          </div>\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default memo(CardListForm);\n"]},"metadata":{},"sourceType":"module"}